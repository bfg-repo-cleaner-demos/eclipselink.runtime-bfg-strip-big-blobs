<?xml version="1.0" encoding="UTF-8"?>

<!--/*******************************************************************************
* Copyright (c) 2007 Oracle. All rights reserved.
* This program and the accompanying materials are made available under the terms of
* the Eclipse Public License v1.0, which accompanies this distribution and is available at
* http://www.eclipse.org/legal/epl-v10.html.
*
* Contributors:
*     Oracle - initial API and implementation
#******************************************************************************/-->
 
<project default="run.junit.gui" basedir=".">

	<target name="init">
		<property file="build.properties"/>
		<property environment="env"/>

		<path id="project.path">
			<pathelement path="${tljaxb.classes}"/>
			<pathelement path="${tljaxb.resources}"/>
			<pathelement path="${tljaxb.resources}/toplink"/>
			<pathelement path="${env.JAVA_HOME}/lib/tools.jar"/>
			<fileset
				dir="${mwtest.jlib}"
				includes="${xmlparser.library},${junit.library},${toplink.library}">
			</fileset>
			<fileset
				dir="${tljaxb.jlib}"
				includes="${additional.libraries}">
			</fileset>
		</path>
	</target>

	<target name="compile.tljaxb.tests" depends="init">
		<delete dir="${tljaxb.classes}"/>
		<mkdir dir="${tljaxb.classes}"/>
		<javac srcdir="${tljaxb.source}"
		       destdir="${tljaxb.classes}"
		       includes="**/*.java"
		       excludes="**/*&#35;*/**, **/.ade_path/**">
		       <classpath refid="project.path"/>
		</javac>
	</target>

	<target name="run.junit.gui" depends="compile.tljaxb.tests">
		<java classname="junit.swingui.TestRunner" fork="true">
			<classpath refid="project.path"/>
		</java>
	</target>

	<target name="run.junit" depends="compile.tljaxb.tests">
		<mkdir dir="${reports.dir}"/>
		<junit printsummary="yes" fork="yes">
			<test name="${testname}" outfile="${reports.dir}/${report.file}">
				<formatter type="xml"/>
			</test>
			<classpath refid="project.path"/>
		</junit>
	</target>

	<target name="junit.report" depends="cleanup,run.junit">
		<mkdir dir="${reports.dir}/html"/>
		<junitreport todir="${reports.dir}">
			<fileset dir="${reports.dir}">
				<include name="*.xml"/>
			</fileset>
			<report format="frames" todir="${reports.dir}/html"/>
		</junitreport>
	</target>

	<target name="cleanup" depends="init">
		<delete dir="${reports.dir}"/>
	</target>
</project>
