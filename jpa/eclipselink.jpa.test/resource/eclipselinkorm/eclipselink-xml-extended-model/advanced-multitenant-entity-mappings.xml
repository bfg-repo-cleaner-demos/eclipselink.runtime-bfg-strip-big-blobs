<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings version="2.3" xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/orm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <description>Advanced Multitenant Test Model Instance Document</description>
    <package>org.eclipse.persistence.testing.models.jpa.xml.advanced.multitenant</package>
    
    <entity name="XMLMafiaFamily" class="MafiaFamily">
        <table name="XML_MAFIA_FAMILY">
            <multitenant>
                <tenant-discriminator-column name="TENANT_ID" context-property="tenant.id"/>
            </multitenant>
        </table>
        <secondary-table name="XML_FAMILY_REVENUE"/>
        <named-query name="findJPQLXMLMafiaFamilies">
            <query>SELECT s from XMLMafiaFamily s</query>
        </named-query>
        <attributes>
            <id name="id">
                <column name="ID"/>
                <generated-value/>
            </id>
            <basic name="name"/>
            <basic name="revenue">
                <column name="REVENUE" table="XML_FAMILY_REVENUE"/>
            </basic>
            <element-collection name="tags">
                <collection-table name="XML_FAMILY_TAGS">
                    <join-column name="FAMILY_ID"/>
                </collection-table>
                <column name="TAG"/>
            </element-collection>
            <one-to-many name="mafiosos" mapped-by="family">
                <cascade>
                    <cascade-all/>
                </cascade>
            </one-to-many>
        </attributes>
    </entity>
    
    <entity name="XMLMafioso" class="Mafioso">
        <table name="XML_MAFIOSO">
            <multitenant>
                <tenant-discriminator-column name="TENANT_ID" context-property="tenant.id"/>
            </multitenant>
        </table>
        <inheritance strategy="JOINED"/>
        <discriminator-column name="DTYPE"/>
        <attributes>
            <id name="id">
                <column name="ID"/>
                <generated-value/>
            </id>
            <basic name="firstName"/>
            <basic name="lastName"/>
            <basic name="gender">
                <object-type-converter name="gender" data-type="String" object-type="Mafioso$Gender">
                    <conversion-value data-value="F" object-value="Female"/>
                    <conversion-value data-value="M" object-value="Male"/>
                </object-type-converter>
            </basic>
            <many-to-one name="family">
                <join-column name="FAMILY_ID"/>
            </many-to-one>
        </attributes>
    </entity>
    
    <entity name="XMLBoss" class="Boss">
        <table name="XML_BOSS"/>
        <discriminator-value name="DON"/>
        <named-query name="UpdateXMLBossName">
            <query>UPDATE XMLBoss b set b.firstName = :name where b.id = :id</query>
        </named-query>
        <attributes>
            <one-to-one name="underboss">
                <join-column name="UNDERBOSS_ID"/>
                <cascade>
                    <cascade-all/>
                </cascade>
            </one-to-one>
        </attributes>
    </entity>
    
    <entity name="XMLUnderboss" class="Underboss">
        <table name="XML_UNDERBOSS"/>
        <discriminator-value name="LITTLE_DON"/>
        <attributes>
            <one-to-one name="boss" mapped-by="underboss">
                <cascade>
                    <cascade-all/>
                </cascade>
            </one-to-one>
            <one-to-many name="capos" mapped-by="underboss"/>
        </attributes>
    </entity>
    
    <entity name="XMLCapo" class="Capo">
        <table name="XML_CAPO"/>
        <discriminator-value name="CAPO"/>
        <attributes>
            <one-to-many name="soldiers" mapped-by="capo"/>
            <many-to-one name="underboss"/>
        </attributes>
    </entity>
    
    <entity name="XMLSoldier" class="Soldier">
        <table name="XML_SOLDIER"/>
        <discriminator-value name="SOLDIER"/>
        <attributes>
            <many-to-one name="capo"/>
            <many-to-many name="contracts" mapped-by="soldiers">
                <cascade>
                    <cascade-all/>
                </cascade>
            </many-to-many>
        </attributes>
    </entity>
    
    <entity name="XMLContract" class="Contract">
        <named-query name="FindAllXmlContracts">
            <query>SELECT c FROM XMLContract c</query>
        </named-query>
        <named-query name="UpdateAllXmlContractDescriptions">
            <query>UPDATE XMLContract c SET c.description = 'voided'</query>
        </named-query>
        <table name="XML_CONTRACT">
            <multitenant type="SINGLE_TABLE"/>
        </table>
        <attributes>
            <id name="id">
                <column name="ID"/>
                <generated-value/>
            </id>
            <basic name="description">
                <column name="DESCRIP"/>
            </basic>
            <basic name="tenantId">
                <column name="TENANT_ID" insertable="false" updatable="false"/>
            </basic>
            <many-to-many name="soldiers">
                <cascade>
                    <cascade-all/>
                </cascade>
                <join-table name="XML_CONTRACT_SOLDIER">
                    <join-column name="CONTRACT_ID"/>
                    <inverse-join-column name="SOLDIER_ID"/>
                </join-table>
            </many-to-many>
            <version name="version"/>
        </attributes>
    </entity>
    
</entity-mappings>
